name: delete-ghcr-images

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  delete-images:
    name: Delete image from ghcr.io
    runs-on: ubuntu-latest
    strategy:
      matrix:
        tag: ['sha256-9d8e012da12e6449723114fb484bae12459cc9cb501c17eac03e7b1ccb743369.sig',
              '2.0.0-buildx-amazoncorretto-17-alpine3-15',
              'sha256-53809537e15bb78d5eef05e810577d53eb8b0840a808e121326328737690a037.sig',
              '2.0.0-kaniko-curated-alpine3.16-openjdk17',
              'sha256-e19c7a251682fd8b439a9588bab8b1ca13c4db2ba559ed8ecda2715b2300fe45.sig',
              '2.0.0-kaniko-amazoncorretto-17-alpine3-15',
              'sha256-d55bd9a9f00f2aca315904f80f5f1c445038fc7a62665e93c6da977f6b04bf6b.sig',
              '2.0.0-buildx-distroless-java17-debian11',
              'sha256-9c301b40bcfbdd8ff0bdcdc21b1f8087fad48af8866df570c91d662fd20f7355.sig',
              '2.0.0-buildx-eclipse-temurin-17-jre-jammy',
              'sha256-46d084921b1f6ebc80a18c97912b3bf844b8416a9bac8ec59a82b17c85d4febc.sig',
              '2.0.0-buildx-distroless-java11-debian11-multistage',
              'sha256-b3b9cf2ed42299aa21664e46d3ef0f9fb4102467b76f40d33bec970cf59bfdf7.sig',
              '2.0.0-cnb-java11',
              'sha256-9f5e7bd959e529735961c54c708a2f3f1cf518851ccba1d105cc336e34ba62d7.sig',
              '2.0.0-podman-eclipse-temurin-17-jre-jammy',
              'sha256-922fcffb75259ed5a856f88e3e6e6805b9d2b90ddc9188dbb0c2a94e583feace.sig',
              '2.0.0-jib-eclipse-temurin-17-jre-jammy',
              'sha256-da0cd99f6210421ec0cf330b9798e2e49de335bb2c8d98199c91139713e43c13.sig',
              'sha256-e5a628b44d7dc75d61e463ca26ec6f191bb393c772bf5a44f281f210b0d347d0.sig',
              '2.0.0-nerdctl-curated-alpine3.16-openjdk17',
              'sha256-3a866cf4cbbf23d22355f7f06c5daf5c8fdab8edd5958be574e7977383eed0c0.sig',
              'sha256-fdadbd7bb8b722b7e0aca917df90e37f0396b01ffc98cccfb7fb9e6d0887813f.sig',
              'sha256-63a1c61d4e81703138ac434d85dc05f23c916a56b145da39422933d99db0fb45.sig',
              'sha256-6f8dea407ab4a7264a93cd987a5b45d4841cd82d7b930bfe0acc7d5268e0afa2.sig',
              'sha256-384cf9292c0559ce94ff33572285de08e320e349a3f1e0108fc7db46430f03d9.sig',
              'sha256-8d365ddcff4a1d27f84e69ee521ffaaabed8307c45b5e296ede95ed9b2bf0f23.sig']
    steps:
      - name: Delete image
        uses: bots-house/ghcr-delete-image-action@v1.0.0
        with:
          owner: codepraxis-io
          name: spring-music
          token: ${{ secrets.GHCR_TOKEN }}
          tag: ${{ matrix.tag }}
